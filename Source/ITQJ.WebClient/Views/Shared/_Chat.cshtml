@{
    var isProfesional = ViewBag.UserRole == "Profesional";
}

<audio id="notification-audio">

    <source src="https://freesound.org/people/grey24/sounds/316798/download/316798__grey24__flyffnotif.wav" type="audio/wav">

    <source src="~/media/audios/new_message.wav" type="audio/wav">

    Your browser does not support the audio element.

</audio>

<div class="d-flex align-items-center" style="position: fixed; right: 0; top: 0; height: 100%;">

    <div id="fixed-right-chat-button">

        <button id="button-chat" onclick="toggleChat()" type="button" class="btn bg-info text-light">

            <i class="fas fa-comment-dots fa-2x m-2"></i>

        </button>

    </div>

</div>

<div id="fixed-bottom-chat" style="width: 500px; position: fixed; bottom: 0; right: 0;">

    <div class="d-flex justify-content-between bg-info mr-2" onclick="toggleChat()">

        @*
            <div class="d-flex align-items-center"
                 style="position: fixed; right: 0; top: 0; height: 100%;">
                <div id="fixed-right-chat-button">
                    <button id="button-chat"
                            onclick="toggleChat()"
                            type="button"
                            class="btn bg-info text-light">
                        <i class="fas fa-comment-dots fa-2x m-2"></i>
                    </button>*@
    </div>

</div>


<div class="bg-white col-md-6" id="fixed-bottom-chat"
     style="
     position: fixed;
     bottom: 0;
     right: 0;
     padding:0px;
     margin:0px;
     border-radius: 5px 5px 0px 0px;
     width:25%">

    <div class="d-flex text-white"
         style="
         background-color: #007BFF;
         padding:0px;
         margin: 0px;
         border-radius: 5px 5px 0px 0px;"
         onclick="toggleChat()">

        <label class="fas fa-comment-dots fa-1x m-2"> </label>

        <span class="h6 card-title text-white d-inline-block m-2">Chat</span>

    </div>

    <div id="chat-container" style="box-sizing:border-box; padding:0px; margin:0px; border:1px solid #BCBCBC;">

        <div id="chat-form" class="row m-0 p-0" style="background-color: #fff;">

            <div class="col border border-primary rounded p-0" style="height: 400px;">

                <div id="chat-box">

                    <div id="messages-list" class="p-2" style="height: 340px; overflow-y: scroll; overflow-x: hidden;"></div>

                    <hr class="m-1 border-primary" />

                    <div class="form-group m-0 p-2">

                        <div class="d-flex align-content-start">

                            <div class="col-10 p-0 " style="margin: .0rem .5rem .0rem .0rem;">

                                <textarea id="message" placeholder="Message" class="form-control"
                                          required maxlength="500" style="width:98.5%; height:40px;"></textarea>

                                <p class="m-0" style="position: absolute; top: 6px; right: 6px;">

                                    <span id="message-count">0</span>/500

                                </p>

                            </div>

                            <img src="/Image/send.svg" id="send" name="send" class="btn-outline-primary" style="height:40px; width:40px; margin:0px; padding:0px; outline: none;" />

                            @*<button  style="outline: none">
                                </button>*@

                        </div>

                    </div>

                </div>

                <div id="chat-placeholder" class="position-absolute"
                     style="left: 0; top: 0; background-color: rgba(255, 255, 255, 0.4); width: 100%; height: 100%;">

                    <div class="d-flex flex-column justify-content-center align-items-center" style="height: 100%;">

                        <i class="fas fa-comment-slash fa-5x"></i>

                        <span class="m-2">There are not messages.</span>

                    </div>

                </div>

            </div>

            <div id="user-list" class="col-5 border border-primary rounded p-0" style="width: 300px; overflow-y: scroll; overflow-x: hidden;">

                <div id="connected-users" class="list-group list-group-flush" role="tablist"></div>

                <div id="users-placeholder" class="position-absolute" style="left: 0; top: 0; background-color: rgba(255, 255, 255, 0.4); width: 100%; height: 100%;">

                    <div class="d-flex flex-column justify-content-center align-items-center" style="height: 100%;">

                        <i class="fas fa-users-slash fa-4x"></i>

                        <span class="m-2">There are not users.</span>

                    </div>

                </div>

            </div>

        </div>

    </div>

</div>

@section Script {
    <script src="~/js/chat.js"></script>

    @if (isProfesional)
    {

        <script src="~/js/chatProfesional.js"></script>

    }
    else
    {

        <script src="~/js/chatContratist.js"></script>

    }

    <script type="text/javascript">

        $(document).ready(() => {

            startChat(@ViewBag.ProjectId, @isProfesional);

        });

    </script>
}

